# üè• SYNT_ISIC: GUI –¥–ª—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–µ—Ä–º–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

[![Python](https://img.shields.io/badge/Python-3.8‚Äì3.11-blue.svg)]()
[![PyTorch](https://img.shields.io/badge/PyTorch-DDPM%20%7C%20UNet2D-red.svg)]()
[![GUI](https://img.shields.io/badge/GUI-PyQt5-informational.svg)]()
[![XAI](https://img.shields.io/badge/XAI-Time--SHAP%20%7C%20Causal--CSI-purple.svg)]()
[![License](https://img.shields.io/badge/Use-Research%20only-lightgrey.svg)]()

**SYNT_ISIC** ‚Äî –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (PyQt5) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ä–º–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ–¥ —Ç–∞–∫—Å–æ–Ω–æ–º–∏—é ISIC (MEL, NV, BCC, AKIEC, BKL, DF, VASC) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **DDPM (UNet2D)** –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏:  
- **Time-SHAP** ‚Äî –∞—Ç—Ä–∏–±—É—Ü–∏—è –≤–∫–ª–∞–¥–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —à–∞–≥–∞–º –¥–µ–Ω–æ–π–∑–∏–Ω–≥–∞ (–¥–æ–∫–∞–∑–∞–Ω–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ –∞–∫—Å–∏–æ–º–∞–º –®—ç–ø–ª–∏);  
- **Causal Validation (CSI)** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–∞—Ñ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏ (noise, blur, shuffle, const).  

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç **–≥–µ–Ω–µ—Ä–∞—Ü–∏—é**, **–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é**, **–∫–∞—É–∑–∞–ª—å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é** –∏ **—ç–∫—Å–ø–æ—Ä—Ç XAI-–æ–≤–µ—Ä–ª–µ–µ–≤** –≤ –µ–¥–∏–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ.  
‚ö†Ô∏è –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è **–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª–µ–π** –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –∏–∑–¥–µ–ª–∏–µ–º.

<div align="center">

[üéØ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã) -  [‚ö° **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫) -  [üìê **XAI –º–µ—Ç–æ–¥—ã**](#-explainability-xai-–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏) -  [üî¨ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**](#-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-–ø–æ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)

</div>

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–î–∞–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç **—Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ä–º–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—ä—è—Å–Ω–∏–º–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π:

### üèóÔ∏è –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **Diffusion backbone**: DDPM + UNet2D —Å attention-–±–ª–æ–∫–∞–º–∏.  
- **Explainability**: Time-SHAP (temporal Shapley attribution), –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Integrated Gradients –∏ SHAP.  
- **Causal robustness**: –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏ (noise/blur/shuffle/const) –∏ –º–µ—Ç—Ä–∏–∫–∞ causal shift (CSI) —Å p-values.  
- **Fairness**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏–∫–∏ –¥–ª—è —Ç—ë–º–Ω—ã—Ö —Ñ–æ—Ç–æ—Ç–∏–ø–æ–≤ –∫–æ–∂–∏ (‚âà8000 –æ–±—Ä–∞–∑—Ü–æ–≤).  
- **GUI**: –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä, –ª–æ–≥–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CPU/GPU.  
- **Reproducibility**: —Ñ–∏–∫—Å–∏—Ä—É–µ–º—ã–µ seeds, —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏ I/O, —ç–∫—Å–ø–æ—Ä—Ç CSV –∏ heatmap-–æ–≤–µ—Ä–ª–µ–µ–≤.


***

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### üîÑ –ü–∞–π–ø–ª–∞–π–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å XAI

```
–°–∏–¥ ‚Üí UNet2D ‚Üí DDPM Scheduler ‚Üí –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí XAI –∞–Ω–∞–ª–∏–∑ ‚Üí –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**

```
SYNT_ISIC/
‚îú‚îÄ‚îÄ core/                  # –ë–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ diffusion/             # –û–±—É—á–∞—é—â–∏–π –∫–æ–¥ (—Å–ø—Ä–∞–≤–æ—á–Ω—ã–π, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è GUI)
‚îú‚îÄ‚îÄ xai/                   # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ download_models.py     # –ó–∞–≥—Ä—É–∑—á–∏–∫ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ PyQt5 GUI
‚îú‚îÄ‚îÄ run_isicgui.bat        # Windows –∑–∞–ø—É—Å–∫–∞—Ç–µ–ª—å
‚îî‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```


### üìê –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã

**–î–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å DDPM:**

```
–ü—Ä—è–º–æ–π: q(x_t|x_{t-1}) = N(x_t; ‚àö(1-Œ≤_t)x_{t-1}, Œ≤_t I)
–û–±—Ä–∞—Ç–Ω—ã–π: p_Œ∏(x_{t-1}|x_t) = N(x_{t-1}; Œº_Œ∏(x_t,t), Œ£_Œ∏(x_t,t))
```

**UNet –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ:**

```
Œ≥(t) = [sin(t/10000^{2k/d}), cos(t/10000^{2k/d})]_{k=0}^{d/2-1}
Œµ_Œ∏(x_t, t) = UNet2D(x_t, Œ≥(t))
```

**XAI –º–µ—Ç–æ–¥—ã:**

```
Integrated Gradients: IG_i(x) = (x_i - x_i')‚à´_{Œ±=0}^1 ‚àÇf(x'+Œ±(x-x'))/‚àÇx_i dŒ±
SHAP: œÜ_i = Œ£_{S‚äÜN\{i}} |S|!(|N|-|S|-1)!/|N|! [v(S‚à™{i}) - v(S)]
```


***

## ‚ö° –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/fims9000/SYNT_ISIC.git
cd SYNT_ISIC

# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv .venv
# Windows PowerShell
.\.venv\Scripts\Activate.ps1
# macOS/Linux  
source .venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install --upgrade pip
pip install -r requirements.txt

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
python download_models.py
```


### üìä –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**Windows:**

```bash
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± - –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫
run_isicgui.bat

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ
python main.py
```

**macOS/Linux:**

```bash
python main.py
```

> **–í–∞–∂–Ω–æ:** –í—Å–µ –ø—É—Ç–∏ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –∑–∞–ø—É—Å–∫ –≤–æ–∑–º–æ–∂–µ–Ω –∏–∑ –ª—é–±–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

***

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å GUI

<details>
<summary><b>üéõÔ∏è –ü–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</b></summary>

### –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å
| –≠–ª–µ–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|---------|------------|-------------|
| **Select Models** | –í—ã–±–æ—Ä –ø–∞–ø–∫–∏ —Å —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏ | –î–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å `unet_<CLASS>_best.pth` |
| **Select Output** | –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è | –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∞–ø–æ–∫ –ø–æ –∫–ª–∞—Å—Å–∞–º |
| **XAI Mode** | –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–ª–æ–∂–µ–Ω–∏–π | Integrated Gradients + SHAP |
| **Device** | CPU/CUDA –≤—ã–±–æ—Ä | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏ GPU |

### –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å
- **–ñ–∏–≤–æ–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä** —Å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ —à–∞–≥–∞–º –¥–µ–Ω–æ–π–∑–∏–Ω–≥–∞ (i/N)
- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ –ª–æ–≥–∏** –ø—Ä–æ—Ü–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –ë–æ–∫–æ–≤—ã–µ –ø–∞–Ω–µ–ª–∏
- **–°–ª–µ–≤–∞:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ ISIC (MEL, NV, BCC, AKIEC, BKL, DF, VASC)
- **–°–ø—Ä–∞–≤–∞:** –ë—Ä–∞—É–∑–µ—Ä —Ñ–∞–π–ª–æ–≤ —Å –¥–µ—Ä–µ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

</details>
<details>
<summary><b>üß† –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</b></summary>

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- **–ú–æ–¥–µ–ª—å:** UNet2D (sample_size=128, RGB, –±–ª–æ–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è)
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫:** DDPMScheduler (1000 —à–∞–≥–æ–≤ –æ–±—É—á–µ–Ω–∏—è, squaredcos_cap_v2)
- **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å:** 50 —à–∞–≥–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ)
- **–°–∏–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:** MD5-–ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è –∫–ª–∞—Å—Å–æ–≤ + –≥–ª–æ–±–∞–ª—å–Ω—ã–π –±–∞–∑–æ–≤—ã–π —Å–∏–¥

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–Ω–æ–π–∑–∏–Ω–≥–∞  
```python
for t in reversed(range(num_inference_steps)):
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —à—É–º–∞ –º–æ–¥–µ–ª—å—é
    noise_pred = unet(latent_sample, t, encoder_hidden_states)
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º
    latent_sample = scheduler.step(noise_pred, t, latent_sample)
```

</details>

***

## üîç Explainability (XAI) –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏

### üìä –ú–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

**Integrated Gradients (–æ—Å–Ω–æ–≤–Ω–æ–π):**

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–º—É –ø—É—Ç–∏ –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç –∞–∫—Å–∏–æ–º–∞–º Sensitivity –∏ Implementation Invariance
- –ë—ã—Å—Ç—Ä–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è

**–ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–π SHAP:**

- –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ç–µ–æ—Ä–∏–∏ –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä –∏ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –®—ç–ø–ª–∏
- –°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–∞–ª–∏—Ü–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**

- –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ü–∏–∏ –≤ –≤–∏–¥–µ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã
- –ê–ª—å—Ñ–∞-–±–ª–µ–Ω–¥–∏–Ω–≥ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–ª–æ–∂–µ–Ω–∏–π


### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ XAI

```python
# –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å XAI –∞–Ω–∞–ª–∏–∑–∞
XAI_OVERLAY_INTERVAL = 10  # –ö–∞–∂–¥–æ–µ 10-–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞  
XAI_SAVE_EVERY_N = 5       # –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è GUI —Å–ø–∏–Ω-–±–æ–∫—Å–æ–º

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
backbone = ResNet18(num_classes=7)  # –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ ISIC –∫–ª–∞—Å—Å—ã
```


***

## ü§ù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### üéØ –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

```bash
pip install -r requirements.txt
python download_models.py
```

2. **–ó–∞–ø—É—Å–∫ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**
    - –ó–∞–ø—É—Å—Ç–∏—Ç–µ `run_isicgui.bat` (Windows) –∏–ª–∏ `python main.py`
    - –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É `checkpoints` —á–µ—Ä–µ–∑ "Select Models"
    - –£–∫–∞–∂–∏—Ç–µ –ø–∞–ø–∫—É –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ "Select Output"
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**
    - –í—ã–±–µ—Ä–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (CPU/CUDA)
    - –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ XAI Mode –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ "XAI steps" –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
    - –û—Ç–º–µ—Ç—å—Ç–µ –Ω—É–∂–Ω—ã–µ –∫–ª–∞—Å—Å—ã –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏
    - –ó–∞–¥–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
    - –ù–∞–∂–º–∏—Ç–µ "Start" –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
5. **–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
    - –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
    - –ò–∑—É—á–∞–π—Ç–µ XAI –Ω–∞–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
    - –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø–∞–ø–∫–∏ –∏ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ –ø—Ä–∞–≤—É—é –ø–∞–Ω–µ–ª—å

### üè• –î–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π

```python
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π
RESEARCH_CONFIG = {
    'base_seed': 42,              # –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å
    'inference_steps': 50,        # –ö–∞—á–µ—Å—Ç–≤–æ vs —Å–∫–æ—Ä–æ—Å—Ç—å  
    'xai_overlay_interval': 10,   # –ß–∞—Å—Ç–æ—Ç–∞ XAI –∞–Ω–∞–ª–∏–∑–∞
    'device': 'cuda:0'            # –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ GPU
}
```


***

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

### üîí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏

- **–ü–∞–º—è—Ç—å GPU:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å:** –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç—Å–∫–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–∏–¥–∞–º–∏
- **–ü—É—Ç–∏:** –í—Å–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `main.py`, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç CWD
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –Ω–∏–∂–Ω–µ–π –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏


### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```
output_folder/
‚îú‚îÄ‚îÄ MEL/                    # –ü–æ–¥–ø–∞–ø–∫–∞ –∫–ª–∞—Å—Å–∞ –º–µ–ª–∞–Ω–æ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ ISIC_0000001.png   # –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ISIC_0000002.png
‚îú‚îÄ‚îÄ NV/                     # –ü–æ–¥–ø–∞–ø–∫–∞ –Ω–µ–≤—É—Å–∞  
‚îÇ   ‚îî‚îÄ‚îÄ ISIC_0000003.png
‚îú‚îÄ‚îÄ synthetic_dataset.csv   # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îî‚îÄ‚îÄ xai_overlays/          # XAI —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã)
```


***

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### üîß –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
| :-- | :-- | :-- |
| **CUDA out of memory** | –ù–µ—Ö–≤–∞—Ç–∫–∞ GPU –ø–∞–º—è—Ç–∏ | –£–º–µ–Ω—å—à–∏—Ç—å batch size –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU |
| **–ú–µ–¥–ª–µ–Ω–Ω—ã–µ XAI –Ω–∞–ª–æ–∂–µ–Ω–∏—è** | SHAP —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–π | –û—Ç–∫–ª—é—á–∏—Ç—å XAI Mode –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª |
| **–û—à–∏–±–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞** | Headless –æ–∫—Ä—É–∂–µ–Ω–∏–µ | –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞ |

### üìã –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python:** 3.8‚Äì3.11
- **–û–°:** Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **RAM:** –ú–∏–Ω–∏–º—É–º 8GB, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 16GB+
- **GPU:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ NVIDIA —Å CUDA 11.0+ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è

***

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### üî¨ –û –ø–∞–ø–∫–µ `diffusion/`

–°–æ–¥–µ—Ä–∂–∏—Ç —Å–ø—Ä–∞–≤–æ—á–Ω—ã–π –∫–æ–¥ –æ–±—É—á–µ–Ω–∏—è –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π:

- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã GUI
- –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –Ω–∞—É—á–Ω–æ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö


### üéì –ù–∞—É—á–Ω–∞—è –æ—Å–Ω–æ–≤–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é, –æ–ø–∏—Å–∞–Ω–Ω—É—é –≤ —Å—Ç–∞—Ç—å–µ:
> –¢—Ä–æ—Ñ–∏–º–æ–≤ –Æ.–í., –ê–≤–µ—Ä–∫–∏–Ω –ê.–ù., –õ–æ–ø–∞—Ç–∏–Ω –ú.–ê., –¢—Ä—É—Å–æ–≤ –ò.–ê.
> "–û–±—ä—è—Å–Ω–∏–º—ã–µ –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è –∏ –∫–∞—É–∑–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è"

***

***

## üéì –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ

<div align="center">

### üèõÔ∏è –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞

**–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –Ω–∞—É–∫–∏ –∏ –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏ (—Ç–µ–º–∞ ‚Ññ 124112200072-2)**

*–î–∞–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –ú–∏–Ω–æ–±—Ä–Ω–∞—É–∫–∏ –†–æ—Å—Å–∏–∏, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ò–ò —Å–∏—Å—Ç–µ–º –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.*

</div>

***

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üîí –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

> **üö® –ò–°–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–°–ö–ò–ô –ò–ù–°–¢–†–£–ú–ï–ù–¢**
> –î–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª–µ–π. –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏ –ø–µ—Ä–µ–¥ –ª—é–±—ã–º –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

### üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è –∏ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ –Ω–∞—É—á–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö –ø—Ä–æ—Å—å–±–∞ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω—ã–º –º–æ–¥–µ–ª—è–º –∏ –º–µ—Ç–æ–¥–∞–º –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏.

***

<div align="center">

**üéØ –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ä–º–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–ª–Ω–æ–π –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å—é –ø—Ä–æ—Ü–µ—Å—Å–∞**

*–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è -  –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ -  –í–∞–ª–∏–¥–∞—Ü–∏—è*
